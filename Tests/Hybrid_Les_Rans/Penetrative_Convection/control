#----------
# Prologue
#----------
 PROBLEM_NAME    pen_conv
 HEAT_TRANSFER   yes

#------------------
# Time integration
#------------------
 TIME_STEP                                1.0
 NUMBER_OF_TIME_STEPS                    7800   # two hours and 10 minutes,
                                                # statistics over an hour
 STARTING_TIME_STEP_FOR_TURB_STATISTICS   600   # start after 10 minutes

 RESULTS_SAVE_INTERVAL     60                   # save results each minute
 BACKUP_SAVE_INTERVAL     600

#-------------------
# Monitoring points 
#-------------------
 NUMBER_OF_MONITORING_POINTS    6
 MONITORING_POINT_001           0.3  0.3   30.05
 MONITORING_POINT_002           0.3  0.3   50.10
 MONITORING_POINT_003           0.3  0.3  200.15
 MONITORING_POINT_004           0.3  0.3  300.20
 MONITORING_POINT_005           0.3  0.3  400.25
 MONITORING_POINT_006           0.3  0.3    0.30

 POINT_FOR_MONITORING_PLANES    0.3  0.3   10.05

#-----------------
# Physical models
#-----------------
 BUOYANCY                       density
 GRAVITATIONAL_VECTOR           0.0,  0.0,  -9.8
 REFERENCE_DENSITY              1.0

# Air
 MASS_DENSITY                     1.21
 THERMAL_CONDUCTIVITY             0.02552
 DYNAMIC_VISCOSITY                1.816e-5
 HEAT_CAPACITY                 1006.0
 VOLUME_EXPANSION_COEFFICIENT     0.0033

 ROUGH_WALLS            yes
 ROUGHNESS_COEFFICIENT  0.16

 TURBULENCE_MODEL       k_eps_zeta_f

#----------------------
# Numerical parameters
#----------------------
 PRESSURE_MOMENTUM_COUPLING    simple

 SIMPLE_UNDERRELAXATION_FOR_MOMENTUM    0.6
 SIMPLE_UNDERRELAXATION_FOR_PRESSURE    0.6
 SIMPLE_UNDERRELAXATION_FOR_ENERGY      0.6
 SIMPLE_UNDERRELAXATION_FOR_TURBULENCE  0.4

 TIME_INTEGRATION_SCHEME  parabolic

 ADVECTION_SCHEME_FOR_MOMENTUM    smart
 ADVECTION_SCHEME_FOR_ENERGY      smart
 ADVECTION_SCHEME_FOR_TURBULENCE  smart

 PRECONDITIONER_FOR_SYSTEM_MATRIX    incomplete_cholesky

 TOLERANCE_FOR_MOMENTUM_SOLVER          1.e-4
 TOLERANCE_FOR_PRESSURE_SOLVER          1.e-4
 TOLERANCE_FOR_ENERGY_SOLVER            1.e-4
 TOLERANCE_FOR_TURBULENCE_SOLVER        1.e-6
 TOLERANCE_FOR_SIMPLE_ALGORITHM         1.e-3
 MAX_ITERATIONS_FOR_PRESSURE_SOLVER   120

#--------------------
# Initial conditions
#--------------------
  INITIAL_CONDITION
    VARIABLES           t2     kin     eps      zeta   f22
    VALUES              0.1    0.001   0.0001   0.03   0.1

#---------------------
# Boundary conditions
#---------------------
  BOUNDARY_CONDITION    lower_boundary
    TYPE                wall_flux
    VARIABLES           u     v     w     q      t2
    VALUES              0.0   0.0   0.0   70.0   0.0

  BOUNDARY_CONDITION    upper_boundary
    TYPE                outflow
    VARIABLES           u     v     w     t      t2
    VALUES              0.0   0.0   0.0   3.24   0.0
