#----------
# Prologue
#----------
 PROBLEM_NAME        fuel_bundle

#-----------------
# Physical models
#-----------------
 TURBULENCE_MODEL    none
 HEAT_TRANSFER       yes
 INTERFACE_TRACKING  yes
 TRACK_FRONT         yes !TRACK_FRONT is new  Why do we need both INTERFACE_TRACKING and TRACK_FRONT?
 MASS_TRANSFER_MODEL lee
 LEE_MODEL_COEFFICIENTS  10000.0  20000.0

#-----------------
# Time step
#-----------------
 TIME_STEP                5.0e-6    !1.0e-5
 NUMBER_OF_TIME_STEPS     20000
 RESULTS_SAVE_INTERVAL    50
 BACKUP_SAVE_INTERVAL     1000
 SAVE_RESULTS_UNITS       no
 #LOAD_BACKUP_NAME         fuel_bundleR3-ts004000.backup
 #SAVE_INITIAL_CONDITION   no

#-----------------
# Material properties: water at 72 bar (287.7 deg)
#-----------------
 PHASE_DENSITIES        37.7     736.5
 PHASE_VISCOSITIES      1.90e-3  9.06e-3
 PHASE_CONDUCTIVITIES   0.0653   0.566
 PHASE_CAPACITIES       5131.7   5446.3
 SURFACE_TENSION        0.0172
 SATURATION_TEMPERATURE 0.0
 LATENT_HEAT            1.49e+6
 GRAVITATIONAL_VECTOR   0.0 0.0 -9.8

#----------------------
# Numerical parameters
#----------------------

 PRESSURE_MOMENTUM_COUPLING   simple 

 SIMPLE_UNDERRELAXATION_FOR_MOMENTUM    0.7   !1.0
 SIMPLE_UNDERRELAXATION_FOR_PRESSURE    0.3   !1.0
 SIMPLE_UNDERRELAXATION_FOR_ENERGY      0.7

 TIME_INTEGRATION_SCHEME  linear

 ADVECTION_SCHEME_FOR_MOMENTUM    quick
 ADVECTION_SCHEME_FOR_VOF         cicsam

 MAX_ITERATIONS_FOR_ENERGY_SOLVER        5
 MAX_ITERATIONS_FOR_MOMENTUM_SOLVER      5

 GU_CORRECTION               yes
 CHOI_CORRECTION             yes

 GRADIENT_METHOD_FOR_PRESSURE        gauss_theorem
 GRADIENT_METHOD_FOR_VOF             gauss_theorem

#  MAX_GAUSS_GRADIENTS_ITERATIONS    200
 TOLERANCE_FOR_GAUSS_GRADIENTS       1.0e-4

#------------------------
# Linear solver settings
#------------------------
 PRECONDITIONER_FOR_SYSTEM_MATRIX   incomplete_cholesky
 TOLERANCE_FOR_MOMENTUM_SOLVER      1.0e-8   <-1.e-12
 TOLERANCE_FOR_PRESSURE_SOLVER      1.0e-8   <-1.e-12
 TOLERANCE_FOR_SIMPLE_ALGORITHM     1.0e-4   <-1.e-03
 TOLERANCE_FOR_VOF_SOLVER           1.0e-8   <-1.e-12
 TOLERANCE_FOR_ENERGY_SOLVER        1.0e-8   <-1.e-03
 MAX_ITERATIONS_FOR_PRESSURE_SOLVER 720
 MIN_SIMPLE_ITERATIONS              6
 MAX_SIMPLE_ITERATIONS              12
 MAX_SMOOTHING_CYCLES_CURVATURE_VOF 12
 MAX_SMOOTHING_CYCLES_NORMAL_VOF    0
 COMPRESION_VOF                      no
# COMPRESION_FACTOR_VOF               1.0
 MIN_SIMPLE_ITERATIONS               3
 #DUAL_TIME_STEP_VOF                 yes

#--------------------
# Initial conditions
#--------------------
  INITIAL_CONDITION
    VARIABLES           u     v     w    t    vof
    VALUES              0.0   0.0   0.2 -1.0  1.0

  POTENTIAL_INITIALIZATION     yes

#---------------------
# Boundary conditions
#---------------------
  BOUNDARY_CONDITION wall
    TYPE             wall
    VARIABLES        u     v     w     t        vof_c_ang
    VALUES           0.0   0.0   0.0   5.0  90.0

  BOUNDARY_CONDITION outlet
    TYPE             outflow  (or: inflow / outflow / pressure / convective)
    VARIABLES        u     v     w     q      vof
    VALUES           0.0   0.0   0.0   0.0    1.0

  BOUNDARY_CONDITION inlet
    TYPE             inflow  (or: inflow / outflow / pressure / convective)
    VARIABLES        u     v     w     t      vof
    VALUES           0.0   0.0   0.2  -1.0    1.0

