#===============================================================================
#
#  Control file for Pipe problem to test single scalar implementation
#
#-------------------------------------------------------------------------------

  PROBLEM_NAME            pipe

  TURBULENCE_MODEL        none
  HEAT_TRANSFER           none

  TIME_STEP                 0.001
  NUMBER_OF_TIME_STEPS    360
  MIN_SIMPLE_ITERATIONS     3
  MAX_SIMPLE_ITERATIONS     6
  RESULTS_SAVE_INTERVAL    60
  BACKUP_SAVE_INTERVAL   3600

#-------------------------------------------------------------------------------
# Physical properties 
#-------------------------------------------------------------------------------

  MASS_DENSITY              1.0      # kg/m^3
  DYNAMIC_VISCOSITY         1.00e-5  # kg/ms
  SCALARS_DIFFUSIVITY       1.43e-5  # m^2/s

  NUMBER_OF_SCALARS 1

#-------------------------------------------------------------------------------
# Numerical parameters 
#-------------------------------------------------------------------------------

  PRESSURE_MOMENTUM_COUPLING    simple

  SIMPLE_UNDERRELAXATION_FOR_MOMENTUM    0.7
  SIMPLE_UNDERRELAXATION_FOR_PRESSURE    0.3
  SIMPLE_UNDERRELAXATION_FOR_SCALARS     1.0

  TIME_INTEGRATION_SCHEME  linear

  ADVECTION_SCHEME_FOR_MOMENTUM    superbee

  GRADIENT_METHOD_FOR_PRESSURE     gauss_theorem
  MAX_GAUSS_GRADIENTS_ITERATIONS   4

#-------------------------------------------------------------------------------
# Linear solver settings
#-------------------------------------------------------------------------------

  PRECONDITIONER_FOR_SYSTEM_MATRIX   incomplete_cholesky
  TOLERANCE_FOR_MOMENTUM_SOLVER      1.e-3
  TOLERANCE_FOR_PRESSURE_SOLVER      1.e-5
  TOLERANCE_FOR_SCALARS_SOLVER       1.e-7

  MAX_ITERATIONS_FOR_MOMENTUM_SOLVER     6
  MAX_ITERATIONS_FOR_SCALARS_SOLVER     18

  TOLERANCE_FOR_SIMPLE_ALGORITHM     1.e-3

  MIN_SIMPLE_ITERATIONS                   6
  MAX_ITERATIONS_FOR_PRESSURE_SOLVER    666

#--------------------------------------------------------------------------------
# Initial condition
#--------------------------------------------------------------------------------

  INITIAL_CONDITION
    VARIABLES              u     v     w    c_01
    VALUES                 0.0   0.0   0.0  0.0

#-------------------------------------------------------------------------------
# Boundary condition (inflow and outflow seem not to work, so I used wall)
#-------------------------------------------------------------------------------

  BOUNDARY_CONDITION internal_wall
    TYPE             wall 
    VARIABLES              u     v     w    c_01
    VALUES                 0.0   0.0   0.0  0.0

  # sobstitute wall with inflow, VALUES with FILE inlet_profile.dat and add rx
  BOUNDARY_CONDITION inlet
    TYPE             wall
    VARIABLES              u     v     w    c_01
    VALUES                 1.0   0.0   0.0  1.0

  # sobstitute wall with outflow
  BOUNDARY_CONDITION outlet
    TYPE             wall
    VARIABLES              u     v     w    c_01
    VALUES                 0.0   0.0   0.0  0.0
#-------------------------------------------------------------------------------
