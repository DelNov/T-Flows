!   https://atmos.washington.edu/~salathe/osx_unix/endian.html   !

!==============================================================================!
  logical function Is_Machine_Little_Endian()
!------------------------------------------------------------------------------!
!   Checks if this is a little endian machine.
!   Returns litend=.true. if it is, litend=.false. if not
!------------------------------------------------------------------------------!
  implicit none
!-----------------------------------[Locals]-----------------------------------!
  integer*1   :: j(2)
  integer*2   :: i
  equivalence :: (i,j)
!==============================================================================!

  i = 1
  if(j(1).eq.1) then
    Is_Machine_Little_Endian = .true.
  else
    Is_Machine_Little_Endian = .false.
  end if

  end function

!==============================================================================!
  subroutine Byte_Swap_Int_2(k)
!------------------------------------------------------------------------------!
!   Does a byteswap on integer(2) number                                       !
!------------------------------------------------------------------------------!
  implicit none
!---------------------------------[Arguments]----------------------------------!
  integer(2) :: k
!-----------------------------------[Locals]-----------------------------------!
  integer*1   :: ii(2), jj(2)
  integer*2   :: i, j
  equivalence :: (i,ii)
  equivalence :: (j,jj)
!==============================================================================!

  i = k

  jj(1) = ii(2)
  jj(2) = ii(1)

  k = j

  end subroutine


!==============================================================================!
  subroutine Byte_Swap_Real_4(k)
!------------------------------------------------------------------------------!
!   Does a byteswap on real(4) number
!------------------------------------------------------------------------------!
!---------------------------------[Arguments]----------------------------------!
  real(4) :: r
!-----------------------------------[Locals]-----------------------------------!
  integer(1)  :: ii(4), jj(4)
  real(4)     :: s, t
  equivalence :: (s,ii)
  equivalence :: (t,jj)
!==============================================================================!

  s = r

  jj(1) = ii(4)
  jj(2) = ii(3)
  jj(3) = ii(2)
  jj(4) = ii(1)

  r = t

  end subroutine
